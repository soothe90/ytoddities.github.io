<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>youtube oddities v1.6</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      max-width: 900px;
      margin: 0 auto;
      padding: 20px;
      background-color: #000000;
    }
    .container {
      background: black;
      border-radius: 12px;
      padding: 30px;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
      text-align: center;
    }
    h1 {
      color: #ccc;
      margin-bottom: 30px;
    }
    .button-container {
      white-space: nowrap;
      margin-bottom: 20px;
    }
    #randomButton, #autoplayButton, #multiButton {
      background: linear-gradient(180deg, 
        rgba(255, 255, 255, 0.9) 0%,
        rgba(255, 255, 255, 0.4) 1%,
        #4a9eff 2%,
        #3d8bdb 48%,
        #2e6bb8 52%,
        #1e4a82 98%,
        rgba(0, 0, 0, 0.2) 99%,
        rgba(0, 0, 0, 0.4) 100%
      );
      color: rgba(255, 255, 255, 0.8);
      border: none;
      padding: 18px 35px;
      font-size: 16px;
      font-weight: 600;
      border-radius: 22px;
      cursor: pointer;
      margin: 8px;
      transition: all 0.15s ease-out;
      box-shadow: 
        0 1px 0 rgba(255, 255, 255, 0.8) inset,
        0 1px 3px rgba(0, 0, 0, 0.3),
        0 0 0 1px rgba(0, 0, 0, 0.2);
      text-shadow: 0 1px 0 rgba(0, 0, 0, 0.5);
      position: relative;
      border: 1px solid rgba(0, 0, 0, 0.3);
      display: inline-block;
    }
    #videoContainer {
      margin-top: 20px;
      position: relative;
    }
    #videoFrame {
      width: 100%;
      max-width: 800px;
      height: 450px;
      border: none;
      border-radius: 8px;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
    }
    /* Grid for 4 videos */
    .video-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 10px;
    }
    .video-grid .player-container {
      width: 100%;
      height: 250px;
      border: none;
      border-radius: 8px;
    }
    .video-info {
      margin-top: 15px;
      color: #aaa;
      font-size: 14px;
    }
  </style>
  <script src="https://www.youtube.com/iframe_api"></script>
</head>
<body>
  <div class="container">
    <h1>youtube oddities v1.6</h1>

    <div class="button-container">
      <button id="randomButton">play random</button>
      <button id="autoplayButton">auto 10s</button>
      <button id="multiButton">switch to 4</button>
    </div>

    <div id="videoContainer">
      <iframe id="videoFrame" src="" allowfullscreen 
        allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture">
      </iframe>
      <div class="video-info">
        <p id="videoInfo">click to start</p>
      </div>
    </div>
  </div>

  <script>
    // Your existing videoIds array goes here
    const videoIds = [
         '3SEI5uXWmVQ',
'gT3fORu93IQ',
'nfxa858l2xw',
'UlDqvz23dI4',
'3SEI5uXWmVQ',
'VfDeOiLq1tM',
'yhAm1Ar57nA',
'yALoS9V0vhs',
'KwcBSalMt3w',
'ybsliS3C3kc',
'0njKy4l58-s',
'SrCIJkKWI_4',
'ab1jDD8SQBM',
'GL1wDE043xk',
'TPIeuVL_YVw',
'00jssUG3oSk',
'yQgvVed07ZE',
'vnl2QmjqbCs',
'kW6kFvyx9PQ',
'TCfLznE6i-U',
'Y8JpIAOTtuE',
'gxceE0DghMk',
'-sBq2lsekGA',
'KQNBriq1VDQ',
'Oy7-JWSTMcc',
'9PlyuTRWSbw',
'GmykwBEQq-Q',
'lrgKjiNUgBM',
'8UIGWjRt1XY',
'3EVh4kCP0kE',
'QCB0wYSSFQY',
'BLJl2k42LOM',
'3gh9kmPPg3o',
'fHQUq6AUVqQ',
'mErJdIpYp98',
'ldSAhpweujg',
'10uL4ttkVb0',
't0sEcNLprAU',
'iSE_ToMOApU',
'b9WMehgt86Y',
'lQp-_1Rtkwg',
'EQis0ir0tvk',
'l7sq79959k8',
'TpK9zjc1eKk',
'QU8iq8U0z_U',
'-XAsxGMyGvk',
'XSbftBrRA7A',
'WIEjjUtO7YI',
'0tzTBjmkBwE',
'k1Pxu_SvbUQ',
'5CEYMBUmetc',
'kLO1X3f3IsY',
'wj0wv0nFVt8',
'aCqdaeZFyEE',
'RgrUfilBaRU',
'oyC-qnP7aII',
'62TCXjGYLIA',
'Cfw95BO_3H8',
'Kd20JYCbk2Y',
'6qjWtxGZuww',
'0p7SglvsSDM',
'3SEI5uXWmVQ',
'gT3fORu93IQ',
'nfxa858l2xw',
'UlDqvz23dI4',
'3SEI5uXWmVQ',
'VfDeOiLq1tM',
'yhAm1Ar57nA',
'yALoS9V0vhs',
'KwcBSalMt3w',
'ybsliS3C3kc',
'0njKy4l58-s',
'SrCIJkKWI_4',
'ab1jDD8SQBM',
'GL1wDE043xk',
'TPIeuVL_YVw',
'00jssUG3oSk',
'yQgvVed07ZE',
'vnl2QmjqbCs',
'kW6kFvyx9PQ',
'TCfLznE6i-U',
'Y8JpIAOTtuE',
'gxceE0DghMk',
'-sBq2lsekGA',
'KQNBriq1VDQ',
'Oy7-JWSTMcc',
'9PlyuTRWSbw',
'GmykwBEQq-Q',
'lrgKjiNUgBM',
'8UIGWjRt1XY',
'3EVh4kCP0kE',
'QCB0wYSSFQY',
'BLJl2k42LOM',
'3gh9kmPPg3o',
'fHQUq6AUVqQ',
'KQNBriq1VDQ',
'mErJdIpYp98',
'ldSAhpweujg'
    ];

    let ytPlayers = []; // Store YouTube Player objects for multi-video mode
    let currentVideoIndex = -1;
    let autoplayMode = false;
    let autoplayInterval = null;
    let autoplaySequence = [];
    let autoplayCurrentIndex = 0;
    let hasUserInteracted = false;
    let isMuted = true;
    let isMultiVideoMode = false;
    let currentVideoIds = []; // Store current 4 video IDs
    let isMultiVideoMuted = true; // Track mute state for 4-video mode

    // YouTube API ready callback
    function onYouTubeIframeAPIReady() {
      console.log('YouTube API Ready');
    }

    // Reset container to single-video layout
    function resetToSingleVideoLayout() {
      const container = document.getElementById('videoContainer');
      // Destroy existing players if in multi-video mode
      if (isMultiVideoMode) {
        ytPlayers.forEach(player => {
          if (player && player.destroy) {
            player.destroy();
          }
        });
        ytPlayers = [];
      }
      isMultiVideoMode = false;
      
      container.innerHTML = `
        <iframe id="videoFrame" src="" allowfullscreen
          allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture">
        </iframe>
        <div class="video-info">
          <p id="videoInfo">click to start playing</p>
        </div>
      `;
    }

    function getRandomVideo() {
      resetToSingleVideoLayout();
      
      // Reset autoplay button to single video mode
      const autoplayBtn = document.getElementById('autoplayButton');
      if (autoplayMode) {
        clearInterval(autoplayInterval);
        autoplayMode = false;
      }
      autoplayBtn.textContent = 'auto 10s';
      
      // Reset multi button
      const multiBtn = document.getElementById('multiButton');
      multiBtn.textContent = 'reset';
      
      if (!hasUserInteracted) { hasUserInteracted = true; isMuted = false; }
      let randomIndex;
      do {
        randomIndex = Math.floor(Math.random() * videoIds.length);
      } while (randomIndex === currentVideoIndex && videoIds.length > 1);
      currentVideoIndex = randomIndex;
      loadVideo(randomIndex);
    }

    function loadVideo(index) {
      const videoId = videoIds[index];
      const iframe = document.getElementById('videoFrame');
      const baseUrl = 'https://www.youtube.com/embed/';
      const params = new URLSearchParams({
  autoplay: hasUserInteracted ? '1' : '0',
  mute: isMuted ? '1' : '0',
  controls: '1',
  rel: '0',
  modestbranding: '1',
  playsinline: '1',
  start: '5'  // ← ADD THIS LINE
});
      const fullUrl = `${baseUrl}${videoId}?${params.toString()}`;
      iframe.src = fullUrl;
      document.getElementById('videoInfo').innerHTML = `
        <strong>now playing</strong><br>
        playing video ${index + 1} of ${videoIds.length}<br>
        <small>ID: ${videoId}</small>
      `;
    }

    function shuffleArray(array) {
      const shuffled = [...array];
      for (let i = shuffled.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [shuffled[i], shuffled[j]] = [shuffled[j], shuffled[i]];
      }
      return shuffled;
    }

    function toggleAutoplay() {
      const button = document.getElementById('autoplayButton');
      
      // If in multi-video mode, handle 4-video autoplay
      if (isMultiVideoMode) {
        if (!autoplayMode) {
          autoplayMode = true;
          button.textContent = 'stop auto 4';
          autoplaySequence = shuffleArray([...Array(videoIds.length).keys()]);
          autoplayCurrentIndex = 0;
          
          // Start autoplay for 4 videos
          autoplayInterval = setInterval(() => {
            autoplayCurrentIndex += 4; // Move by 4 videos each time
            if (autoplayCurrentIndex >= videoIds.length) {
              autoplaySequence = shuffleArray([...Array(videoIds.length).keys()]);
              autoplayCurrentIndex = 0;
            }
            
            // Load next 4 videos
            loadNext4Videos();
          }, 10000);
        } else {
          autoplayMode = false;
          button.textContent = 'auto 4';
          clearInterval(autoplayInterval);
          autoplayInterval = null;
        }
        return;
      }

      // Original single video autoplay logic
      resetToSingleVideoLayout();
      if (!hasUserInteracted) { hasUserInteracted = true; isMuted = false; }
      
      if (!autoplayMode) {
        autoplayMode = true;
        button.textContent = 'stop auto';
        autoplaySequence = shuffleArray([...Array(videoIds.length).keys()]);
        autoplayCurrentIndex = 0;
        loadVideo(autoplaySequence[autoplayCurrentIndex]);
        autoplayInterval = setInterval(() => {
          autoplayCurrentIndex++;
          if (autoplayCurrentIndex >= autoplaySequence.length) {
            autoplaySequence = shuffleArray([...Array(videoIds.length).keys()]);
            autoplayCurrentIndex = 0;
          }
          loadVideo(autoplaySequence[autoplayCurrentIndex]);
        }, 10000);
      } else {
        autoplayMode = false;
        button.textContent = 'auto 10s';
        clearInterval(autoplayInterval);
        autoplayInterval = null;
      }
    }

    function loadNext4Videos() {
      // Get next 4 unique videos starting from current index
      let picked = [];
      if (videoIds.length >= 4) {
        for (let i = 0; i < 4; i++) {
          const index = (autoplayCurrentIndex + i) % videoIds.length;
          picked.push(videoIds[autoplaySequence[index]]);
        }
      } else {
        picked = [...new Set(videoIds)];
      }
      currentVideoIds = picked;

      // Destroy existing players
      ytPlayers.forEach(player => {
        if (player && player.destroy) {
          player.destroy();
        }
      });
      ytPlayers = [];

      const container = document.getElementById('videoContainer');
      const grid = container.querySelector('.video-grid');
      
      // Clear and recreate player containers
      grid.innerHTML = '';
      picked.forEach((id, index) => {
        const playerDiv = document.createElement('div');
        playerDiv.id = `player-${index}`;
        playerDiv.className = 'player-container';
        grid.appendChild(playerDiv);
      });

      // Update info
      const infoElement = container.querySelector('.video-info');
      const muteStatus = isMultiVideoMuted ? 'muted' : 'with sound';
      infoElement.innerHTML = `<strong>playing 4 videos ${muteStatus}</strong><br>IDs: ${picked.join(', ')}`;

      // Initialize new players
      setTimeout(() => {
        picked.forEach((id, index) => {
          const player = new YT.Player(`player-${index}`, {
            height: '100%',
            width: '100%',
            videoId: id,
            playerVars: {
  'autoplay': 1,
  'mute': isMultiVideoMuted ? 1 : 0,
  'controls': 1,
  'rel': 0,
  'modestbranding': 1,
  'playsinline': 1,
  'start': 5  // ← ADD THIS LINE
}
          });
          ytPlayers.push(player);
        });
      }, 100);
    }

    // Multi-video function that also works as mute/unmute
    function handleMultiButton() {
      const multiBtn = document.getElementById('multiButton');
      const autoplayBtn = document.getElementById('autoplayButton');

      // If already in multi-video mode, toggle mute/unmute
      if (isMultiVideoMode) {
        toggleMuteAllVideos();
        return;
      }

      // Stop single video autoplay if active
      if (autoplayMode && !isMultiVideoMode) {
        clearInterval(autoplayInterval);
        autoplayMode = false;
      }

      // Switch to multi-video mode
      isMultiVideoMode = true;
      isMultiVideoMuted = true; // Start muted
      
      // Update button texts
      autoplayBtn.textContent = 'auto 4';
      multiBtn.textContent = 'unmute';

      const container = document.getElementById('videoContainer');
      container.innerHTML = '';

      const grid = document.createElement('div');
      grid.className = 'video-grid';

      // Get 4 unique videos
      let picked = [];
      if (videoIds.length >= 4) {
        picked = shuffleArray(videoIds).slice(0, 4);
      } else {
        picked = [...new Set(videoIds)];
      }
      currentVideoIds = picked;

      // Create player containers
      picked.forEach((id, index) => {
        const playerDiv = document.createElement('div');
        playerDiv.id = `player-${index}`;
        playerDiv.className = 'player-container';
        grid.appendChild(playerDiv);
      });

      container.appendChild(grid);

      const info = document.createElement('div');
      info.className = 'video-info';
      info.innerHTML = `<strong>playing 4 videos muted</strong><br>IDs: ${picked.join(', ')}`;
      container.appendChild(info);

      // Initialize YouTube players
      setTimeout(() => {
        picked.forEach((id, index) => {
          const player = new YT.Player(`player-${index}`, {
            height: '100%',
            width: '100%',
            videoId: id,
            playerVars: {
  'autoplay': 1,
  'mute': 1,
  'controls': 1,
  'rel': 0,
  'modestbranding': 1,
  'playsinline': 1,
  'start': 5  // ← ADD THIS LINE
}
          });
          ytPlayers.push(player);
        });
      }, 100);
    }

    // Toggle mute/unmute function
    function toggleMuteAllVideos() {
      if (!isMultiVideoMode || ytPlayers.length === 0) return;

      const multiBtn = document.getElementById('multiButton');
      const infoElement = document.querySelector('.video-info');

      ytPlayers.forEach((player, index) => {
        if (player && (player.unMute || player.mute)) {
          try {
            if (isMultiVideoMuted) {
              player.unMute();
            } else {
              player.mute();
            }
          } catch (error) {
            console.log(`Error toggling mute for player ${index}:`, error);
          }
        }
      });

      // Toggle mute state and update UI
      isMultiVideoMuted = !isMultiVideoMuted;
      
      if (isMultiVideoMuted) {
        multiBtn.textContent = 'unmute';
        if (infoElement) {
          infoElement.innerHTML = `<strong>playing 4 videos muted</strong><br>IDs: ${currentVideoIds.join(', ')}`;
        }
      } else {
        multiBtn.textContent = 'mute';
        if (infoElement) {
          infoElement.innerHTML = `<strong>playing 4 videos with sound</strong><br>IDs: ${currentVideoIds.join(', ')}`;
        }
      }
    }

    // Event listeners
    document.getElementById('randomButton').addEventListener('click', getRandomVideo);
    document.getElementById('autoplayButton').addEventListener('click', toggleAutoplay);
    document.getElementById('multiButton').addEventListener('click', handleMultiButton);

    // Initialize first video on load
    window.addEventListener('load', () => {
      const firstVideoId = videoIds[0];
      const iframe = document.getElementById('videoFrame');
      iframe.src = `https://www.youtube.com/embed/${firstVideoId}?controls=1&rel=0&modestbranding=1&start=5`;
    });
  </script>
</body>
</html>
