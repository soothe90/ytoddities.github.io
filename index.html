<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>youtube oddities v1.6</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      max-width: 900px;
      margin: 0 auto;
      padding: 20px;
      background-color: #000000;
    }
    .container {
      background: black;
      border-radius: 12px;
      padding: 30px;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
      text-align: center;
    }
    h1 {
      color: #ccc;
      margin-bottom: 30px;
    }
    .button-container {
      white-space: nowrap;
      margin-bottom: 20px;
    }
    #randomButton, #autoplayButton, #multiButton {
      background: linear-gradient(180deg, 
        rgba(255, 255, 255, 0.9) 0%,
        rgba(255, 255, 255, 0.4) 1%,
        #4a9eff 2%,
        #3d8bdb 48%,
        #2e6bb8 52%,
        #1e4a82 98%,
        rgba(0, 0, 0, 0.2) 99%,
        rgba(0, 0, 0, 0.4) 100%
      );
      color: rgba(255, 255, 255, 0.8);
      border: none;
      padding: 18px 35px;
      font-size: 16px;
      font-weight: 600;
      border-radius: 22px;
      cursor: pointer;
      margin: 8px;
      transition: all 0.15s ease-out;
      box-shadow: 
        0 1px 0 rgba(255, 255, 255, 0.8) inset,
        0 1px 3px rgba(0, 0, 0, 0.3),
        0 0 0 1px rgba(0, 0, 0, 0.2);
      text-shadow: 0 1px 0 rgba(0, 0, 0, 0.5);
      position: relative;
      border: 1px solid rgba(0, 0, 0, 0.3);
      display: inline-block;
    }
    #videoContainer {
      margin-top: 20px;
      position: relative;
    }
    #videoFrame {
      width: 100%;
      max-width: 800px;
      height: 450px;
      border: none;
      border-radius: 8px;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
    }
    /* Grid for 4 videos */
    .video-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 10px;
    }
    .video-grid .player-container {
      width: 100%;
      height: 250px;
      border: none;
      border-radius: 8px;
    }
    .video-info {
      margin-top: 15px;
      color: #aaa;
      font-size: 14px;
    }
  </style>
  <script src="https://www.youtube.com/iframe_api"></script>
</head>
<body>
  <div class="container">
    <h1>youtube oddities v1.6</h1>

    <div class="button-container">
      <button id="randomButton">play random</button>
      <button id="autoplayButton">auto 10s</button>
      <button id="multiButton">switch to 4</button>
    </div>

    <div id="videoContainer">
      <iframe id="videoFrame" src="" allowfullscreen 
        allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture">
      </iframe>
      <div class="video-info">
        <p id="videoInfo">click to start</p>
      </div>
    </div>
  </div>

  <script>
    // Your existing videoIds array goes here
    const videoIds = [
          'nwwyeHciU_I', 'A9PWDBsNh1E', 'iWwGcHaqcDg', 'tx8cKA_6yqI', 'LqvjA3lGHw4', 'EuixgTMaUxc', 'R3431Q1Fylo', '6iPx8Xgl9cA', 'Wp-Kmixz1qs', 'AbdzVnxGghU', 'dNDUuUNdKG4', 'ytuEHbIwjD8', 'I6XfspIVdDg', 'bq06bt82MOA', 'MeHqfxVlheA', 'oqnCRKeVasE', 'cYJbVNcjXlQ', '8bJKPx2D18U', 'vYA1ZEsk2Io', 'v1QE_beLTvk', 'KWK6R91R2Ow', 'o7wSYHzneZc', 'LgRQhl1sCAA', 'RxiBJTec4rI', 'TzinUakikM0', 'Pahm611ndMc', 'YYN3pq4qaJ0', 'edDytch_JCc', 'LUImAdUZIZg', 'CYQuH5l7CfY', 'IDvkR2VfBJo', 'WX9UcZDa4VI', '3nIn4V-QeQo', 'XZfpLAxjiFw', 'lbd8d3sk2Pc', 'Sk0CJBhhdFU', 'TtmZM-ktGKU', '-pFiRSoMy0M', 'zIPa-X7BvpA', '6vfsGijaxEI', 'dwLd-v36Ybw', 'Xk1SVsA4mzw', 'CYkF-Rloshs', 'TKJjdPTFghw', 'tUx0sw-H0I0', 'MTqg1EQhdNw', '87mC309-0zk', 'L3MWfj6kOB0', 'YoeAMHdcGrg', 'OZ_v1oiWbso', 'abQAAAsbkLw', 'bc0tDG9x7jY', 'N-MYQ9JuRAA', '-AZhgxe824M', 'FdNnTyKq98g', '67IWkkQGXCk', 'PkvOohvrdlg', 'ZTymY9Qx-WI', 'AgCNjLq7I8c', 'jg9U9dkavEE', '5TrOYUuffK0', 'am6TQ-ah5_0', '4AbE4zOWUK4', 'iAwBGiikVjc', '8IRE0XSmuGk', 'SKysu5yeE44', '1740m7ZZpAI', 'nWLzGwqfzr8', 'j7NHO9IqV2Q', 'tLa5902Fspo', 'FaEebfuwres', 'LaEddUKCf7g', 'BuKDC8h8_hc', 'Css_3vfdXW0', 'EZLoRgrmnys', 'QeBaCcirGMo', 'ugjsYlKXJKA', 'uOIJUyfQb30', 'Q5iF_4A1i9I', 'Lkwor7OJWNs', '0Pa0R2AO-L8', '9ngvVQWUvpk', 'J44TABAGMaI', 'UU1ECW31eBs', 'lxgkUaP1DGc', 'BWBXdYzY03I', '-9JvWuzrPrc', 'aP_ykHTw01o', '76vSXYOISTE', 'vVqRVARrnvU', 'utKF31x7gZU', 'ioz7bQsb5WA', 'zroRV0Cxyw8', 'BMAP-de5diw', 'eXzIjTHHLI4', 'pi3axJ4i-r8', '8jX5C24OLEw', '0eK8r3FD7Nw', 'sTddEsprgbI', 'djQkq1Poj6o', 'EV-FW9gunPY', 't1uibtBU39A', 'BMgbEsnqL4k', 'CWfkoR0hKoE', 'fv38bxeS4xw', 'xCl4ncXlzbI', 'gaCgmSPsA_A', 'uA3NVgk34YA', 'XBtBHGp1BSQ', 'ypT3OelEWp4', 'mEa-TGe9AQU', 'DX1HYL8sltk', 'kSkZ5veyf5M', 'oHsa0BLhh1s', 'JaXk-wDyivE', '7vuDnZgbumA', 'L_JB48GiNPE', '_GsQIJEBfgM', 'alwsmwARcuw', 'BwTtq-qnT4E', 'THLcktC079I', '2K4BC-EAjGo', 'WIh740QWvy4', 'Jf4p_bOIVSE', 'oXupMlQVLz8', 'CNW930ikDro', 'Zol5uZSeDH8', 'dIveVvHKr1I', 'sDH3d0th-gk', 'V5HgnHQjLdA'
    ];

    let ytPlayers = []; // Store YouTube Player objects for multi-video mode
    let currentVideoIndex = -1;
    let autoplayMode = false;
    let autoplayInterval = null;
    let autoplaySequence = [];
    let autoplayCurrentIndex = 0;
    let hasUserInteracted = false;
    let isMuted = true;
    let isMultiVideoMode = false;
    let currentVideoIds = []; // Store current 4 video IDs
    let isMultiVideoMuted = true; // Track mute state for 4-video mode

    // YouTube API ready callback
    function onYouTubeIframeAPIReady() {
      console.log('YouTube API Ready');
    }

    // Reset container to single-video layout
    function resetToSingleVideoLayout() {
      const container = document.getElementById('videoContainer');
      // Destroy existing players if in multi-video mode
      if (isMultiVideoMode) {
        ytPlayers.forEach(player => {
          if (player && player.destroy) {
            player.destroy();
          }
        });
        ytPlayers = [];
      }
      isMultiVideoMode = false;
      
      container.innerHTML = `
        <iframe id="videoFrame" src="" allowfullscreen
          allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture">
        </iframe>
        <div class="video-info">
          <p id="videoInfo">click to start playing</p>
        </div>
      `;
    }

    function getRandomVideo() {
      resetToSingleVideoLayout();
      
      // Reset autoplay button to single video mode
      const autoplayBtn = document.getElementById('autoplayButton');
      if (autoplayMode) {
        clearInterval(autoplayInterval);
        autoplayMode = false;
      }
      autoplayBtn.textContent = 'auto 10s';
      
      // Reset multi button
      const multiBtn = document.getElementById('multiButton');
      multiBtn.textContent = 'reset';
      
      if (!hasUserInteracted) { hasUserInteracted = true; isMuted = false; }
      let randomIndex;
      do {
        randomIndex = Math.floor(Math.random() * videoIds.length);
      } while (randomIndex === currentVideoIndex && videoIds.length > 1);
      currentVideoIndex = randomIndex;
      loadVideo(randomIndex);
    }

    function loadVideo(index) {
      const videoId = videoIds[index];
      const iframe = document.getElementById('videoFrame');
      const baseUrl = 'https://www.youtube.com/embed/';
      const params = new URLSearchParams({
  autoplay: hasUserInteracted ? '1' : '0',
  mute: isMuted ? '1' : '0',
  controls: '1',
  rel: '0',
  modestbranding: '1',
  playsinline: '1',
  start: '5'  // ← ADD THIS LINE
});
      const fullUrl = `${baseUrl}${videoId}?${params.toString()}`;
      iframe.src = fullUrl;
      document.getElementById('videoInfo').innerHTML = `
        <strong>now playing</strong><br>
        playing video ${index + 1} of ${videoIds.length}<br>
        <small>ID: ${videoId}</small>
      `;
    }

    function shuffleArray(array) {
      const shuffled = [...array];
      for (let i = shuffled.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [shuffled[i], shuffled[j]] = [shuffled[j], shuffled[i]];
      }
      return shuffled;
    }

    function toggleAutoplay() {
      const button = document.getElementById('autoplayButton');
      
      // If in multi-video mode, handle 4-video autoplay
      if (isMultiVideoMode) {
        if (!autoplayMode) {
          autoplayMode = true;
          button.textContent = 'stop auto 4';
          autoplaySequence = shuffleArray([...Array(videoIds.length).keys()]);
          autoplayCurrentIndex = 0;
          
          // Start autoplay for 4 videos
          autoplayInterval = setInterval(() => {
            autoplayCurrentIndex += 4; // Move by 4 videos each time
            if (autoplayCurrentIndex >= videoIds.length) {
              autoplaySequence = shuffleArray([...Array(videoIds.length).keys()]);
              autoplayCurrentIndex = 0;
            }
            
            // Load next 4 videos
            loadNext4Videos();
          }, 10000);
        } else {
          autoplayMode = false;
          button.textContent = 'auto 4';
          clearInterval(autoplayInterval);
          autoplayInterval = null;
        }
        return;
      }

      // Original single video autoplay logic
      resetToSingleVideoLayout();
      if (!hasUserInteracted) { hasUserInteracted = true; isMuted = false; }
      
      if (!autoplayMode) {
        autoplayMode = true;
        button.textContent = 'stop auto';
        autoplaySequence = shuffleArray([...Array(videoIds.length).keys()]);
        autoplayCurrentIndex = 0;
        loadVideo(autoplaySequence[autoplayCurrentIndex]);
        autoplayInterval = setInterval(() => {
          autoplayCurrentIndex++;
          if (autoplayCurrentIndex >= autoplaySequence.length) {
            autoplaySequence = shuffleArray([...Array(videoIds.length).keys()]);
            autoplayCurrentIndex = 0;
          }
          loadVideo(autoplaySequence[autoplayCurrentIndex]);
        }, 10000);
      } else {
        autoplayMode = false;
        button.textContent = 'auto 10s';
        clearInterval(autoplayInterval);
        autoplayInterval = null;
      }
    }

    function loadNext4Videos() {
      // Get next 4 unique videos starting from current index
      let picked = [];
      if (videoIds.length >= 4) {
        for (let i = 0; i < 4; i++) {
          const index = (autoplayCurrentIndex + i) % videoIds.length;
          picked.push(videoIds[autoplaySequence[index]]);
        }
      } else {
        picked = [...new Set(videoIds)];
      }
      currentVideoIds = picked;

      // Destroy existing players
      ytPlayers.forEach(player => {
        if (player && player.destroy) {
          player.destroy();
        }
      });
      ytPlayers = [];

      const container = document.getElementById('videoContainer');
      const grid = container.querySelector('.video-grid');
      
      // Clear and recreate player containers
      grid.innerHTML = '';
      picked.forEach((id, index) => {
        const playerDiv = document.createElement('div');
        playerDiv.id = `player-${index}`;
        playerDiv.className = 'player-container';
        grid.appendChild(playerDiv);
      });

      // Update info
      const infoElement = container.querySelector('.video-info');
      const muteStatus = isMultiVideoMuted ? 'muted' : 'with sound';
      infoElement.innerHTML = `<strong>playing 4 videos ${muteStatus}</strong><br>IDs: ${picked.join(', ')}`;

      // Initialize new players
      setTimeout(() => {
        picked.forEach((id, index) => {
          const player = new YT.Player(`player-${index}`, {
            height: '100%',
            width: '100%',
            videoId: id,
            playerVars: {
  'autoplay': 1,
  'mute': isMultiVideoMuted ? 1 : 0,
  'controls': 1,
  'rel': 0,
  'modestbranding': 1,
  'playsinline': 1,
  'start': 5  // ← ADD THIS LINE
}
          });
          ytPlayers.push(player);
        });
      }, 100);
    }

    // Multi-video function that also works as mute/unmute
    function handleMultiButton() {
      const multiBtn = document.getElementById('multiButton');
      const autoplayBtn = document.getElementById('autoplayButton');

      // If already in multi-video mode, toggle mute/unmute
      if (isMultiVideoMode) {
        toggleMuteAllVideos();
        return;
      }

      // Stop single video autoplay if active
      if (autoplayMode && !isMultiVideoMode) {
        clearInterval(autoplayInterval);
        autoplayMode = false;
      }

      // Switch to multi-video mode
      isMultiVideoMode = true;
      isMultiVideoMuted = true; // Start muted
      
      // Update button texts
      autoplayBtn.textContent = 'auto 4';
      multiBtn.textContent = 'unmute';

      const container = document.getElementById('videoContainer');
      container.innerHTML = '';

      const grid = document.createElement('div');
      grid.className = 'video-grid';

      // Get 4 unique videos
      let picked = [];
      if (videoIds.length >= 4) {
        picked = shuffleArray(videoIds).slice(0, 4);
      } else {
        picked = [...new Set(videoIds)];
      }
      currentVideoIds = picked;

      // Create player containers
      picked.forEach((id, index) => {
        const playerDiv = document.createElement('div');
        playerDiv.id = `player-${index}`;
        playerDiv.className = 'player-container';
        grid.appendChild(playerDiv);
      });

      container.appendChild(grid);

      const info = document.createElement('div');
      info.className = 'video-info';
      info.innerHTML = `<strong>playing 4 videos muted</strong><br>IDs: ${picked.join(', ')}`;
      container.appendChild(info);

      // Initialize YouTube players
      setTimeout(() => {
        picked.forEach((id, index) => {
          const player = new YT.Player(`player-${index}`, {
            height: '100%',
            width: '100%',
            videoId: id,
            playerVars: {
  'autoplay': 1,
  'mute': 1,
  'controls': 1,
  'rel': 0,
  'modestbranding': 1,
  'playsinline': 1,
  'start': 5  // ← ADD THIS LINE
}
          });
          ytPlayers.push(player);
        });
      }, 100);
    }

    // Toggle mute/unmute function
    function toggleMuteAllVideos() {
      if (!isMultiVideoMode || ytPlayers.length === 0) return;

      const multiBtn = document.getElementById('multiButton');
      const infoElement = document.querySelector('.video-info');

      ytPlayers.forEach((player, index) => {
        if (player && (player.unMute || player.mute)) {
          try {
            if (isMultiVideoMuted) {
              player.unMute();
            } else {
              player.mute();
            }
          } catch (error) {
            console.log(`Error toggling mute for player ${index}:`, error);
          }
        }
      });

      // Toggle mute state and update UI
      isMultiVideoMuted = !isMultiVideoMuted;
      
      if (isMultiVideoMuted) {
        multiBtn.textContent = 'unmute';
        if (infoElement) {
          infoElement.innerHTML = `<strong>playing 4 videos muted</strong><br>IDs: ${currentVideoIds.join(', ')}`;
        }
      } else {
        multiBtn.textContent = 'mute';
        if (infoElement) {
          infoElement.innerHTML = `<strong>playing 4 videos with sound</strong><br>IDs: ${currentVideoIds.join(', ')}`;
        }
      }
    }

    // Event listeners
    document.getElementById('randomButton').addEventListener('click', getRandomVideo);
    document.getElementById('autoplayButton').addEventListener('click', toggleAutoplay);
    document.getElementById('multiButton').addEventListener('click', handleMultiButton);

    // Initialize first video on load
    window.addEventListener('load', () => {
      const firstVideoId = videoIds[0];
      const iframe = document.getElementById('videoFrame');
      iframe.src = `https://www.youtube.com/embed/${firstVideoId}?controls=1&rel=0&modestbranding=1&start=5`;
    });
  </script>
</body>
</html>
